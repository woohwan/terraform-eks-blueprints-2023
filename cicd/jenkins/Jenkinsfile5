pipeline {
  agent {
    kubernetes {
      inheritFrom 'kaniko'
    }
  }
  stages {
    stage('build') {
      steps {
        git branch: 'main', url: 'https://github.com/woohwan/cicd.git'
        container('kaniko') {
            dir('jenkins/examples/fastapi') {
                sh "/kaniko/executor --dockerfile=Dockerfile --context `pwd` --destination=whpark70/fastapi:latest"
            }
        }
      }
    }
  }
}